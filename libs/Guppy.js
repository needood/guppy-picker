!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):t.Guppy=n()}(this,function(){"use strict";function t(t){function e(n){return function(){o.set(n,t[n].apply(o,arguments))}}function r(n){return function(){t[n].apply(o,arguments)}}t=H(this.defaultOptions,t);var i,o=this;if("undefined"!=typeof t){var s={};if(t["default"]){var u=t["default"];"function"==typeof u&&(s=u())}this.set=function(t,n){return s[t]=n,this.trigger("change:"+t,this),s},this.get=function(t){return s[t]},this.mount=function(t){return i=t,this.trigger("mount",i),this},this.getElement=function(){return i};for(var c in t){var f=t[c];if(D.isFunction(f)&&"object"===n(f.__guppy_properties__)&&f.__guppy_properties__.length>0){var a=f.__guppy_properties__[0];"string"==typeof a&&this.on("change:"+a,e(c))}if(D.isFunction(f)&&"object"===n(f.__guppy_observes__)&&f.__guppy_observes__.length>0){var l=f.__guppy_observes__[0];"string"==typeof l&&this.on("change:"+l,r(c))}if(D.isFunction(f)&&"object"===n(f.__guppy_on__)&&f.__guppy_on__.length>0){var p=f.__guppy_on__[0];"string"==typeof p&&this.on(p,r(c))}}return this.trigger("init",this),this}}Function.prototype.$observes=function(){var t=this;return t.__guppy_observes__=arguments,t},Function.prototype.$properties=function(){var t=this;return t.__guppy_properties__=arguments,t},Function.prototype.$on=function(){var t=this;return t.__guppy_on__=arguments,t};for(var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},e=Object.prototype,r=Array.isArray,i=e.toString,o=function(t){return function(n){return null==n?void 0:n[t]}},s=Math.pow(2,53)-1,u=o("length"),c={isArrayLike:function(t){var n=u(t);return"number"==typeof n&&n>=0&&n<=s},isArray:r||function(t){return"[object Array]"===i.call(t)},isFunction:function(t){return"function"==typeof t},isObject:function(t){var e="undefined"==typeof t?"undefined":n(t);return"function"===e||"object"===e&&!!t}},f=["Arguments","Function","String","Number","Date","RegExp","Error"],a=0;a<f.length;a++)!function(t){c["is"+t]=function(n){return i.call(n)==="[object "+t+"]"}}(f[a]);c.isArguments(arguments)||(c.isArguments=function(t){return t.hasOwnProperty("callee")});var l=c,p=l,h=/\s+/,y=Object.keys,v={create:function(t){var n=document.createElement("div");return n.innerHTML=t,n.removeChild(n.children[0])},addClass:function(t,n){return A(t,function(t){if(""===t.className)t.className=n;else{var e=t.className,r=[];A(n.split(h),function(t){new RegExp("\\b("+t+")\\b").test(e)||r.push(" "+t)}),t.className+=r.join("")}return t})},setClass:function(t,n){return A(t,function(t){return t.className=n,t})},hasClass:function(t,n){return new RegExp("\\b("+n.split(h).join("|")+")\\b").test(t.className)},removeClass:function(t,n){return A(t,function(t){return t.className=n?E.trim(t.className.replace(new RegExp("\\b("+n.split(h).join("|")+")\\b","g"),"").split(h).join(" ")):"",t})}},g={before:function(t,n){var e;return function(){return--t>0&&(e=n.apply(this,arguments)),t<=1&&(n=null),e}},once:function(t){return g.before.call(this,2,t)}},d=function(t){return null==t||(p.isArrayLike(t)&&(p.isArray(t)||p.isString(t)||p.isArguments(t))?0===t.length:0===k(t).length)},b=0,m=function(t){var n=++b+"";return t?t+n:n},j=function(t,n){return null!=t&&hasOwnProperty.call(t,n)},x=function(t){if(window._)return _.allKey;if(!p.isObject(t))return[];var n=[];for(var e in t)n.push(e);return n},k=function(t){return window._?_.keys:p.isObject(t)?y?y(t):void 0:[]},O=function(t,n){return function(e){var r=arguments.length;if(r<2||null==e)return e;for(var i=1;i<r;i++)for(var o=arguments[i],s=t(o),u=s.length,c=0;c<u;c++){var f=s[c];n&&void 0!==e[f]||(e[f]=o[f])}return e}},w=O(x),A=function(t,n){if(null!==t){if(void 0===n)return t;if(!p.isArray(t))return n(t);for(var e=0;e<t.length;e++)n(t[e])}},E={camelCase:function(t){return t.replace("-ms-","ms-").replace(rcamelCase,function(t,n){return(n+"").toUpperCase()})},replace:function(t,n){for(var e in n)t=t.replace(new RegExp(e,"ig"),n[e]);return t},slashes:function(t){return $string.replace(t,{"\\\\":"\\\\","\b":"\\b","\t":"\\t","\n":"\\n","\r":"\\r",'"':'\\"'})},trim:"".trim?function(t){return t.trim()}:function(t){return(t+"").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}},N={stringOpt:E,uniqueId:m,has:j,allKeys:x,extend:w,keys:k,funcOpt:g,isEmpty:d,mapcall:A,domOpt:v},C=N.funcOpt,F=N.isEmpty,T=N.keys,S=N.uniqueId,I=Array.prototype.slice,R={on:function(t,n,e){if(!L(this,"on",t,[n,e])||!n)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:n,context:e,ctx:e||this}),this},once:function W(t,n,e){if(!L(this,"once",t,[n,e])||!n)return this;var r=this,W=C.once(function(){r.off(t,W),n.apply(this,arguments)});return W._callback=n,this.on(t,W,e)},off:function(t,n,e){var r,i,o,s,u,c,f,a;if(!this._events||!L(this,"off",t,[n,e]))return this;if(!t&&!n&&!e)return this._events=void 0,this;for(s=t?[t]:T(this._events),u=0,c=s.length;u<c;u++)if(t=s[u],o=this._events[t]){if(this._events[t]=r=[],n||e)for(f=0,a=o.length;f<a;f++)i=o[f],(n&&n!==i.callback&&n!==i.callback._callback||e&&e!==i.context)&&r.push(i);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var n=I.call(arguments,1);if(!L(this,"trigger",t,n))return this;var e=this._events[t],r=this._events.all;return e&&q(e,n),r&&q(r,arguments),this},stopListening:function(t,e,r){var i=this._listeningTo;if(!i)return this;var o=!e&&!r;r||"object"!==("undefined"==typeof e?"undefined":n(e))||(r=this),t&&((i={})[t._listenId]=t);for(var s in i)t=i[s],t.off(e,r,this),(o||F(t._events))&&delete this._listeningTo[s];return this}},$=/\s+/,L=function(t,e,r,i){if(!r)return!0;if("object"===("undefined"==typeof r?"undefined":n(r))){for(var o in r)t[e].apply(t,[o,r[o]].concat(i));return!1}if($.test(r)){for(var s=r.split($),u=0,c=s.length;u<c;u++)t[e].apply(t,[s[u]].concat(i));return!1}return!0},q=function(t,n){var e,r=-1,i=t.length,o=n[0],s=n[1],u=n[2];switch(n.length){case 0:for(;++r<i;)(e=t[r]).callback.call(e.ctx);return;case 1:for(;++r<i;)(e=t[r]).callback.call(e.ctx,o);return;case 2:for(;++r<i;)(e=t[r]).callback.call(e.ctx,o,s);return;case 3:for(;++r<i;)(e=t[r]).callback.call(e.ctx,o,s,u);return;default:for(;++r<i;)(e=t[r]).callback.apply(e.ctx,n);return}},K={listenTo:"on",listenToOnce:"once"};for(var M in K)!function(t,e){R[e]=function(e,r,i){var o=this._listeningTo||(this._listeningTo={}),s=e._listenId||(e._listenId=S("l"));return o[s]=e,i||"object"!==("undefined"==typeof r?"undefined":n(r))||(i=this),e[t](r,i,this),this}}(K[M],M);R.bind=R.on,R.unbind=R.off;var P=R,D=l,G=N,H=G.extend,U=G.has,z=function(t,n){var e,r=this;e=t&&U(t,"constructor")?t.constructor:function(){return r.apply(this,arguments)},H(e,r,n);var i=function(){this.constructor=e};return i.prototype=r.prototype,e.prototype=new i,t&&H(e.prototype,t),e.__super__=r.prototype,e};t.defaultOptions={},t.extend=z,t.utils=G,t.isType=D;var B=P;H(t.prototype,B);var J=t,Q=J,V=Q;return V});
